<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Numerical Observation Time | Bryan Lawrence</title>
  <meta name="description" content="Over four years ago I had a series of conversations with colleagues, that led to my blog posts on meteorological time.Jeremy Tandy has subsequently refined our thinking of all those years ago in a ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.bnlawrence.net//computing/2011/01/numerical_observation_time/">
  <link rel="alternate" type="application/rss+xml" title="Bryan Lawrence" href="http://www.bnlawrence.net//feed.xml" />
<link rel='stylesheet' id='open-sans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.2.4' type='text/css' media='all' />
<link href='http://fonts.googleapis.com/css?family=Titillium+Web:600italic,600,400,400italic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://www.osu.edu/assets/fonts/webfonts.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">






<!-- Twitter cards -->
<meta name="twitter:site"    content="@bnlawrence">
<meta name="twitter:title"   content="Numerical Observation Time">


<meta name="twitter:description" content="Over four years ago I had a series of conversations with colleagues, that led to my blog posts on meteorological time.
Jeremy Tandy has subsequently refined our thinking of all those years ago in a...">



<meta name="twitter:card"  content="summary">
<meta name="twitter:image" content="">

<!-- end of Twitter cards -->

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Bryan Lawrence</a>


    <nav class="site-nav">

      <a href="#" class="menu-icon menu.open">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

    <div class="trigger"><h1>Main Navigation</h1>

 <ul class="menu">

    
    
     <li><a href="/" class="page-link">Home</a>
    
    </li>
    
    
     <li><a href="/about/" class="page-link">About</a>
    
    </li>
    
    
    <li><a href="/academic/" class="page-link">Academic</a>
    <ul class="sub-menu">
    
    <li><a href="/academic/">Academic</a></li>
    
    <li><a href="/projects/">Projects</a></li>
    
    <li><a href="/publications/">Publications</a></li>
    
    <li><a href="/cv/">Short CV</a></li>
    
    <li><a href="/research/">Research</a></li>
    
    <li><a href="/talks/">Talks</a></li>
    
    </ul>
    
    </li>
    
    
     <li><a href="/blog/" class="page-link">Blog</a>
    
    </li>
    
    
     <li><a href="/search/" class="page-link">Find</a>
    
    </li>
    
    </ul>


     </div>
    </nav>
</div>
<div class="wrapper">
   <p> Intermittent rambings on climate, computing, or data science, what I'm up to, and what I'm thinking. Mostly professional, sometimes not.
 </p>
</div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

 <header class="post-header">
  <h1 class="post-title">Numerical Observation Time</h1>
  <p class="post-meta">Posted on January 7, 2011
  
  
      in
      
      <a href="/categories/#computing" title="computing">computing</a>&nbsp;
      
  
  
  
  (tagged: <a href="/tags/metafor/" rel="tag">metafor</a>, <a href="/tags/metadata/" rel="tag">metadata</a>).
  
  <br/>
  
  
  Previous Post: <a class="prev" href="/computing/2011/01/citation_digital_object_identifiers_persistence_correction_and_metadata/">&laquo;Citation, Digital Object Identifiers, Persistence, Correction and Metadata&raquo;</a>
  
  .<br/>
   Next Post <a class="next" href="/environment/2011/01/weather_forecastings_bad_name/">&laquo;Weather Forecasting's Bad Name&raquo;</a>
  
  
  (in <a href="/categories/#environment" title="environment">environment</a>;
  in <a href="/categories/#computing" title="computing">computing</a> next is <a href="/computing/2011/02/pushing_water_analogies_too_far/" class="next">&laquo;Pushing Water Analogies too far&raquo;</a>)
  
  .
  </p>
</header>


  <article class="post-content">
    <p>Over four years ago I had a series of conversations with colleagues, that led to my <a href="/computing/2006/04/more_meteorological_time/">blog posts</a> on meteorological time.
Jeremy Tandy has subsequently refined our thinking of all those years ago in a <a href="http://metafortrac.badc.rl.ac.uk/trac/attachment/wiki/tickets/920/OGC%20Met-Ocean%20DWG%2BIts-about-time%2B2010-12-10%20%28TANDY%29%20v2.1.pdf">cogent proposal</a> intended for both OGC and WMO which casts the discussion of “forecast time” in an <a href="http://metafortrac.badc.rl.ac.uk/trac/attachment/wiki/tickets/920/Observation%20Core.png">observations and measurements</a> framework.</p>

<p>Jeremy’s proposal is detailed and well thought through, but I don’t think it fully covers all the edge cases, so this post is by way revising my post from 2006 in the context of Jeremy’s proposal. In doing so, I guess I’m suggesting some minor changes to Jeremy, but I’m also writing this for the benefit of both myself and metafor.</p>

<p>By way of context then, here is my 2006 figure, redrafted to remove some implicit assumptions in what I wrote then:</p>

<p><img src="/assets/images/2011-01-06-ForecastDataSets4.png" alt="Image: ForecastDataSets4.png " /></p>

<p>The diagram shows a number of different  datasets that can be constructed from daily forecast runs (shown for an arbitrary month from the 12th til the 15th as forecasts 1 through 4. If we consider forecast 2, we are running it to give me a forecast from T<sub>0</sub>(day 13.0) forward past day 14.5 … but you can see that the simulation began (in this case 1.0) days earlier, at a simulation time of 12.0.</p>

<p>(NB: all symbols as defined in this post, not any previous one. Note that all times shown are times in the forecast reference frame, even though the diagram shows a progression of such times marked as real time … the diagram doesn’t show when the runs were actually completed.)</p>

<p>The key concepts are that:</p>

<ol>
  <li>Forecasts begin with an assimilation period delineated by an initialisation time and a time of last possible observational data input (also known as the datum time, T<sub>d</sub>).
    <ul>
      <li>In the diagram, the initialisation time is 24 hours before T<sub>0</sub>, but it could be any period - including no period of assimilation at all.</li>
      <li>Some forecasts simply continue as model runs with no new data acquired after T<sub>d</sub>, in this case T<sub>0</sub> is the same as T<sub>d</sub>.</li>
      <li>(Thus far these times are all in the forecast reference frame. Jeremy’s presentation is hot on these distinctions!)</li>
    </ul>
  </li>
  <li><em>Analyses</em> are generally produced for some time in the observation window (aka assimilation window), sometimes, but often not at the end (see for example <a href="http://www.ecmwf.int/products/forecasts/guide/The_4DVAR_analysis_procedure.html">ECMWF 4D Var</a>).
    <ul>
      <li>Analyses are used for many things, but one of the most important, is the initialisation data for a future forecast, as shown here in the case of using them to initialise the next days run. Another possibility is that an analysis from within the window is used to start a current forecast with a different resolution or version of the model. (As a consequence, we often find the assimilation portion of the run is not archived with the forecast portion.)</li>
    </ul>
  </li>
  <li>Sometimes <em>Analysis Datasets</em> are produced by using the actual analyses with higher frequency data provided by taking data from the forecasts in a consistent way.
    <ul>
      <li>Two examples are shown in the diagram for T<sub>0</sub>, where we have assumed for convenience that the analysis time is the same as the datum time.
        <ul>
          <li>In case <em>a</em>, data from the <em>last</em> forecast is used to provide the interim data points. In this example this data is from the free running model after assimilation. This is often a good thing to do for physical variables which are not being directly assimilated - these are often more physically in balance after the assimilation window.</li>
          <li>In case <em>b</em>, data from the <em>next</em> forecast is used to provide the interim points.</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p>OK: with that language in mind, we can turn to Jeremy’s OGC proposal.</p>

<p>Jeremy makes the key distinction between times <em>of the observation event</em> (which belong on the observation entity), and times <em>of the result of the observation</em>. (In this context the Observation is the Simulation).</p>

<p>Looking at Jeremy’s times of interest, we have:</p>

<ol>
  <li>The result times which appear in the result coverage. These are straight forwardly the times that the simulation thinks it is valid for (we’ll come back to validity).
    <ul>
      <li>The  bounding box of these times, the duration of the run, should appear in the MD_Metadata associated with the observation!</li>
      <li>It should also appear as the phenomenonTime in OM_Observation.</li>
      <li>We could have multiple datasets extracted from the forecasts above which had exactly the same result times and result bounding boxes (e.g. day 13 to day 14 from forecasts 1, 2 and 3 - noting the latter would include data from the assimilation period - or a composite analysis of days 13 to 14 via routes a or b).</li>
    </ul>
  </li>
  <li>Jeremy rightly states <em>It is the metadata about the simulation event that enables us to distinguish between these results</em>
    <ul>
      <li>(From a metafor point of view, that clearly tells us our “simulation” class needs to be a specialisation of OM_Observation.)</li>
      <li>We sometimes talk about a <em>reference time</em> which is often associated with the <em>analysis time</em> (T<sub>0</sub> in our case), but it could be the initialisation time T<sub>init</sub>, or even the datum time (T<sub>d</sub> is not always equal to T<sub>0</sub>).
        <ul>
          <li>These are not standard O&amp;M concepts, and would need to go in as named parameters, and this is where I differ from Jeremy: Because the reference time is somewhat ambiguous (is it T<sub>0</sub> or T<sub>init</sub>), I would explicitly distinguish between them (even though often they are the same since the assimilation and forecast runs are separate). To distinguish, I would have a referenceTime which was explicitly defined as T<sub>init</sub>, and add an optional datum time (and it’s absence would indicate no assimilation).</li>
        </ul>
      </li>
      <li>OM_Observation also has validTime, which could be confused with the phenomenonTime in the case of forecasts - but it isn’t intended to be the same as validity time in the meteorological sense. If we use it, it should indicate a period in the <em>real time</em> reference frame (not forecast time reference frame) for which the forecast is intended to be used.</li>
      <li>OM_Observation also has resultTime, which is the time at which the event “happened”. Jeremy unpicks this well in his document. The bottom line is that it should correspond to when the result became available … in the <em>real time</em> reference frame.</li>
    </ul>
  </li>
  <li>Jeremy suggests that observation mashups (like the horizontal dataset constructed using T<sub>0</sub> output plus either <em>a</em> or <em>b</em> data would not retain any semantics. In this I disagree, since these are “effective observations”. The process will of course describe the detail of the mashup methodology, but I think the observation has to give some hint via it’s time attributes how it was done. The interesting thing there is the output dataset consists of a series of {analysis field followed by 1.. n forecast field} sets.
We need a notation for that. Which is more than I’m going to do today …</li>
</ol>

<p>By way of summary, this blog post summarises some things from Jeremy’s proposal, and makes some minor quibbles. Overall I think it’s an excellent proposal.</p>

<h4 id="comments-2">comments (2)</h4>

<p><em>Jeremy Tandy (on Tuesday 11 January, 2011)</em></p>

<p>Bryan - thanks for the feedback. Reading through your comments, you’ve unpicked a level of complexity that I don’t often see in the ‘operational meteorology’ context that I am most familiar with … here, most folks don’t really <em>care</em> about T-init or T-d (to use your terminology) as the same pattern repeats every day. It’s the analysis time (T-0) that folk refer to. However, thanks to your descriptions, I can now see that this additional metadata does provide additional utility in other contexts.</p>

<p>I will attempt to incorporate your feedback into an update version of the proposal ready for a second pass through the BNL gateway!</p>

<p>One point to check my understanding - where 4DVar assimilation is used, can T-d be AFTER T-0? In my operational context we fudge this detail by refering to T-0 as the ‘nominal analysis time’.</p>

<p><em>Bryan (on Sunday 30 January, 2011)</em></p>

<p>Yes! The ECMWF example shows exactly that.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">
    <hr/>
<!--     <h2 class="footer-heading">Bryan Lawrence</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><strong>Bryan Lawrence</strong></li>
		  <li>Professional Meeting Attendee</li>
          <li><a href="mailto:b.n.lawrence@reading.ac.uk">b.n.lawrence@reading.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">

          
          <li>
              <a href="https://github.com/bnlawrence">
              <i class="fa fa-github" style="color:gray"></i> bnlawrence
             </a>
          </li>
          

          
          <li>
             <a href="https://twitter.com/bnlawrence">
             <i class="fa fa-twitter" style="color:gray"></i> bnlawrence
             </a>
          </li>
          

        </ul>
      </div>

      <div class="footer-col  footer-col-3">
         <p class="text">
	     This is a personal site. Caveat Lector. Nothing written here reflects an official opinion of my employer or any funding agency. Laboris locatores analogum obsecro respice auferetur. (My daughter is learning Latin, unlike me, who never did!)

      </div>
    </div>
    <!--
    <hr/>
    <p class="text"> This is a personal site. Caveat Lector. Nothing written here reflects an official opinion of my employer or any funding agency. Laboris locatores analogum obsecro respice auferetur. (My daughter is learning Latin, unlike me, who never did!)
 </p>
    -->

  </div>

</footer>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111008496-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111008496-1');
</script>

    
  </body>


</html>
<!-- d.050600.062508.030515.080516 | "Baby, I'm Yours" -->
